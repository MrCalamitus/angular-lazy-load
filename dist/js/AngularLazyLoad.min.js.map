{"version":3,"file":"AngularLazyLoad.min.js","sources":["../../src/js/LodashShim.js","../../src/js/Main.js","../../src/js/OnScrollTo.js","../../src/js/LazyLoadConfigProvider.js","../../src/js/AngularLazyLoad.js"],"sourcesContent":["if (!window._) {\n  window._ = {\n    throttle: function(fn, threshhold, scope) {\n      threshhold || (threshhold = 250);\n      var last, deferTimer;\n      return function () {\n        var context = scope || this;\n        var now = +new Date,\n            args = arguments;\n        if (last && now < last + threshhold) {\n          clearTimeout(deferTimer);\n          deferTimer = setTimeout(function () {\n            last = now;\n            fn.apply(context, args);\n          }, threshhold + last - now);\n        } else {\n          last = now;\n          fn.apply(context, args);\n        }\n      }\n    }\n  }\n}\n\nexport default window._;","import OnScrollTo from './OnScrollTo.js';\nimport LazyLoadProvider from './LazyLoadConfigProvider.js';\nimport AngularLazyLoad from './AngularLazyLoad.js';\n\nangular.module('angular-lazy-load', [])\n  .directive('onScrollTo', OnScrollTo)\n  .provider('lazyLoad', LazyLoadProvider)\n  .directive('lazyLoad', AngularLazyLoad);","import _ from './LodashShim.js';\n\nlet OnScrollTo = ['$window', '$timeout', 'lazyLoad', ($window, $timeout, lazyLoad) => {\n  let defaults = {\n    intersectionThreshold: 0.1,\n    throttleWait: 20,\n    unobserveInstantly: true,\n    useIntersectionObserver: lazyLoad.useIntersectionObserver,\n    intersectionRoot: null,\n    intersectionRootMargin: \"0px\",\n    scrollOffset: lazyLoad.scrollOffset\n  };\n  return {\n    restrict: 'A',\n    link(scope, element, attrs) {\n      let fn = scope.$eval(attrs.onScrollTo);\n      let attrOptions = {\n        intersectionRatio: scope.$eval(attrs.scrollThreshold),\n        throttleWait: scope.$eval(attrs.scrollThrottle),\n        unobserveInstantly: scope.$eval(attrs.scrollUnobserve),\n        intersectionRoot: scope.$eval(attrs.scrollRoot),\n        intersectionRootMargin: scope.$eval(attrs.scrollRootMargin),\n        scrollOffset: scope.$eval(attrs.scrollOffset),\n        useIntersectionObserver: scope.$eval(attrs.useIo)\n      };\n      let options = defaults;\n      for (let k in attrOptions) {\n        let v = attrOptions[k];\n        if (v != null) { options[k] = v; }\n      }\n      if (options.useIntersectionObserver &&\n        (typeof IntersectionObserver !== 'undefined')) {\n        let rootMargin = \"0px\";\n        if (options.scrollOffset != null) {\n          if (options.intersectionRootMargin) {\n            let parts = options.intersectionRootMargin.split(\" \").splice(0, 1);\n            parts = parts.concat([`${options.scrollOffset}px`]);\n            rootMargin = parts.join(\" \");\n          } else {\n            rootMargin = `0px 0px 0px ${options.scrollOffset}px`;\n          }\n        }\n        var io = new IntersectionObserver(function(entries) {\n          if (entries[0].intersectionRatio == 0) { return; }\n          scope.$apply(fn);\n          if (options.unobserveInstantly) {\n            return io.unobserve(element[0]);\n          }\n          }, {\n          root: options.intersectionRoot,\n          rootMargin: options.intersectionRootMargin,\n          threshold: options.intersectionThreshold\n          });\n        return io.observe(element[0]);\n      } else {\n        let scrollOffset = options.scrollOffset || 0;\n        let scrollHandler = _.throttle(function(e) {\n          let docViewTop = $window.scrollY;\n          let docViewBottom = docViewTop + $window.innerHeight;\n          let elemTop = element[0].offsetTop;\n          let elemBottom = elemTop + element[0].offsetHeight;\n          if ((elemBottom <= docViewBottom + scrollOffset) && (elemTop >= docViewTop - scrollOffset)) {\n            scope.$apply(fn);\n            if (options.unobserveInstantly) {\n              return $window.removeEventListener('scroll', scrollHandler);\n            }\n          }\n        }\n        , options.throttleWait\n        );\n        $window.addEventListener('scroll', scrollHandler);\n        return $timeout(scrollHandler);\n      }\n    }\n  };\n}];\n\nexport default OnScrollTo;","let LazyLoadProvider = function() {\n  this.scrollOffset = null;\n  this.useIntersectionObserver = true;\n  this.setScrollOffset = function(newScrollOffset) {\n    this.scrollOffset = newScrollOffset;\n  };\n  this.setUseIntersectionObserver = function(newUseIO) {\n    this.useIntersectionObserver = newUseIO;\n  };\n  this.$get = function() {\n    return this;\n  };\n};\n\nexport default LazyLoadProvider;","let AngularLazyLoad = ['lazyLoad', (lazyLoad) => {\n  return {\n    restrict: 'A',\n    controller: ['$element', function($element) {\n      this.scrollOffset = lazyLoad.scrollOffset;\n      this.aot = $element.attr('aot') || false;\n      this.scrollHandler = (e) => {\n        if ($element.attr('lazy-src')) {\n          $element.attr('src', $element.attr('lazy-src'));\n          $element.removeAttr('lazy-src');\n        }\n        if ($element.attr('use-io')) {\n          $element.removeAttr('use-io');\n        }\n      }\n    }],\n    controllerAs: 'll',\n    template: \"<img on-scroll-to='ll.scrollHandler' use-io='!ll.aot' />\",\n    replace: true,\n    priority: 50\n  }\n}];\n\nexport default AngularLazyLoad;"],"names":["window","_","throttle","fn","threshhold","scope","last","deferTimer","context","now","Date","args","arguments","clearTimeout","setTimeout","apply","angular","module","directive","OnScrollTo","$window","$timeout","lazyLoad","defaults","intersectionThreshold","throttleWait","unobserveInstantly","useIntersectionObserver","intersectionRoot","intersectionRootMargin","scrollOffset","restrict","link","element","attrs","$eval","onScrollTo","attrOptions","intersectionRatio","scrollThreshold","scrollThrottle","scrollUnobserve","scrollRoot","scrollRootMargin","useIo","k","v","IntersectionObserver","parts","split","splice","concat","join","io","entries","$apply","unobserve","root","rootMargin","threshold","observe","scrollHandler","e","docViewTop","scrollY","elemTop","offsetTop","offsetHeight","innerHeight","removeEventListener","addEventListener","provider","LazyLoadProvider","setScrollOffset","this.setScrollOffset","newScrollOffset","setUseIntersectionObserver","this.setUseIntersectionObserver","newUseIO","$get","this.$get","AngularLazyLoad","controller","$element","aot","attr","this.scrollHandler","removeAttr","controllerAs","template","replace","priority"],"mappings":"YAAKA,MAAAC,EAAL,GACED,MAAAC,EADF,CACa,CACTC,SAAUA,SAASC,EAAIC,EAAYC,EAAO,CACxCD,CAAA,GAAeA,CAAf,CAA4B,GAA5B,CADwC,KAEpCE,CAFoC,CAE9BC,CACV,OAAO,WAAY,CACjB,IAAIC,EAAUH,CAAVG,EAAmB,IAAvB,CACIC,EAAM,CAAC,IAAIC,IADf,CAEIC,EAAOC,SACPN,EAAJ,EAAYG,CAAZ,CAAkBH,CAAlB,CAAyBF,CAAzB,EACES,YAAA,CAAaN,CAAb,CACA,CAAAA,CAAA,CAAaO,UAAA,CAAW,UAAY,CAClCR,CAAA,CAAOG,CACPN,EAAAY,MAAA,CAASP,CAAT,CAAkBG,CAAlB,CAFkC,CAAvB,CAGVP,CAHU,CAGGE,CAHH,CAGUG,CAHV,CAFf,GAOEH,CACA,CADOG,CACP,CAAAN,CAAAY,MAAA,CAASP,CAAT,CAAkBG,CAAlB,CARF,CAJiB,CAHqB,CADjC,CADb,CAwBA,OAAeX,MAAAC,ECpBfe,QAAAC,OAAA,CAAe,mBAAf,CAAoC,EAApC,CAAAC,UAAA,CACa,YADb,CCFiBC,CAAC,SAADA,CAAY,UAAZA,CAAwB,UAAxBA,CAAoC,QAAA,CAACC,CAAD,CAAUC,CAAV,CAAoBC,CAApB,CAAiC,CACpF,IAAIC,EAAW,CACbC,sBAAuB,EADV,CAEbC,aAAc,EAFD,CAGbC,mBAAoB,CAAA,CAHP,CAIbC,wBAAyBL,CAAAK,wBAJZ,CAKbC,iBAAkB,IALL,CAMbC,uBAAwB,KANX;AAObC,aAAcR,CAAAQ,aAPD,CASf,OAAO,CACLC,SAAU,GADL,CAELC,KAAAA,QAAI,CAAC3B,CAAD,CAAQ4B,CAAR,CAAiBC,CAAjB,CAAwB,CAC1B,IAAI/B,EAAKE,CAAA8B,MAAA,CAAYD,CAAAE,WAAZ,CACLC,EAAAA,CAAc,CAChBC,kBAAmBjC,CAAA8B,MAAA,CAAYD,CAAAK,gBAAZ,CADH,CAEhBd,aAAcpB,CAAA8B,MAAA,CAAYD,CAAAM,eAAZ,CAFE,CAGhBd,mBAAoBrB,CAAA8B,MAAA,CAAYD,CAAAO,gBAAZ,CAHJ,CAIhBb,iBAAkBvB,CAAA8B,MAAA,CAAYD,CAAAQ,WAAZ,CAJF,CAKhBb,uBAAwBxB,CAAA8B,MAAA,CAAYD,CAAAS,iBAAZ,CALR,CAMhBb,aAAczB,CAAA8B,MAAA,CAAYD,CAAAJ,aAAZ,CANE,CAOhBH,wBAAyBtB,CAAA8B,MAAA,CAAYD,CAAAU,MAAZ,CAPT,CAUlB,KAAKC,IAAIA,CAAT,GAAcR,EAAd,CAA2B,CACzB,IAAIS,EAAIT,CAAA,CAAYQ,CAAZ,CACC,KAAT,EAAIC,CAAJ,GAHYvB,CAGK,CAAQsB,CAAR,CAAjB,CAA8BC,CAA9B,CAFyB,CAI3B,GALcvB,CAKVI,wBAAJ,EACmC,WADnC,GACG,MAAOoB,qBADV,CACiD,CAEnB,IAA5B;AARYxB,CAQRO,aAAJ,EARYP,CASNM,uBADN,GAEQmB,CAES,CAZLzB,CAUIM,uBAAAoB,MAAA,CAAqC,GAArC,CAAAC,OAAA,CAAiD,CAAjD,CAAoD,CAApD,CAEC,CADbF,CACa,CADLA,CAAAG,OAAA,CAAa,CAXb5B,CAWiBO,aAAJ,CAAwB,IAAxB,CAAb,CACK,CAAAkB,CAAAI,KAAA,CAAW,GAAX,CAJjB,CASA,KAAIC,EAAK,IAAIN,oBAAJ,CAAyB,SAASO,EAAS,CAClD,GAAoC,CAApC,EAAIA,CAAA,CAAQ,CAAR,CAAAhB,kBAAJ,GACAjC,CAAAkD,OAAA,CAAapD,CAAb,CACIuB,CApBMH,CAoBNG,mBAFJ,EAGE,MAAO2B,EAAAG,UAAA,CAAavB,CAAA,CAAQ,CAAR,CAAb,CAJyC,CAA3C,CAMJ,CACHwB,KAxBUlC,CAwBJK,iBADH,CAEH8B,WAzBUnC,CAyBEM,uBAFT,CAGH8B,UA1BUpC,CA0BCC,sBAHR,CANI,CAWT,OAAO6B,EAAAO,QAAA,CAAW3B,CAAA,CAAQ,CAAR,CAAX,CAtBwC,CAwB/C,IAAIH,EA9BQP,CA8BOO,aAAfA,EAAuC,CAA3C,CACI+B,EAAgB5D,CAAAC,SAAA,CAAW,SAAS4D,EAAG,CACrCC,CAAAA,CAAa3C,CAAA4C,QAEjB,KAAIC,EAAUhC,CAAA,CAAQ,CAAR,CAAAiC,UAEd,IADiBD,CACjB,CAD2BhC,CAAA,CAAQ,CAAR,CAAAkC,aAC3B,EAHoBJ,CAGpB;AAHiC3C,CAAAgD,YAGjC,CAAmCtC,CAAnC,EAAqDmC,CAArD,EAAgEF,CAAhE,CAA6EjC,CAA7E,GACEzB,CAAAkD,OAAA,CAAapD,CAAb,CACIuB,CAtCIH,CAsCJG,mBAFN,EAGI,MAAON,EAAAiD,oBAAA,CAA4B,QAA5B,CAAsCR,CAAtC,CAR8B,CAAvB,CA/BRtC,CA2CVE,aAZkB,CAcpBL,EAAAkD,iBAAA,CAAyB,QAAzB,CAAmCT,CAAnC,CACA,OAAOxC,EAAA,CAASwC,CAAT,CAzDiB,CAFvB,CAV6E,CAArE1C,CDEjB,CAAAoD,SAAA,CAEY,UAFZ,CEJuBC,UAAW,CAChC,IAAA1C,aAAA,CAAoB,IACpB,KAAAH,wBAAA,CAA+B,CAAA,CAC/B,KAAA8C,gBAAA,CAAuBC,SAASC,EAAiB,CAC/C,IAAA7C,aAAA,CAAoB6C,CAD2B,CAGjD,KAAAC,2BAAA,CAAkCC,SAASC,EAAU,CACnD,IAAAnD,wBAAA,CAA+BmD,CADoB,CAGrD,KAAAC,KAAA,CAAYC,UAAW,CACrB,MAAO,KADc,CATS,CFIlC,CAAA9D,UAAA,CAGa,UAHb,CGJsB+D,CAAC,UAADA,CAAa,QAAA,CAAC3D,CAAD,CAAc,CAC/C,MAAO,CACLS,SAAU,GADL,CAELmD,WAAY,CAAC,UAAD;AAAa,SAASC,EAAU,CAC1C,IAAArD,aAAA,CAAoBR,CAAAQ,aACpB,KAAAsD,IAAA,CAAWD,CAAAE,KAAA,CAAc,KAAd,CAAX,EAAmC,CAAA,CACnC,KAAAxB,cAAA,CAAqByB,QAAA,CAACxB,CAAD,CAAO,CACtBqB,CAAAE,KAAA,CAAc,UAAd,CAAJ,GACEF,CAAAE,KAAA,CAAc,KAAd,CAAqBF,CAAAE,KAAA,CAAc,UAAd,CAArB,CACA,CAAAF,CAAAI,WAAA,CAAoB,UAApB,CAFF,CAIIJ,EAAAE,KAAA,CAAc,QAAd,CAAJ,EACEF,CAAAI,WAAA,CAAoB,QAApB,CANwB,CAHc,CAAhC,CAFP,CAeLC,aAAc,IAfT,CAgBLC,SAAU,sEAhBL,CAiBLC,QAAS,CAAA,CAjBJ,CAkBLC,SAAU,EAlBL,CADwC,CAA3BV,CHItB;"}